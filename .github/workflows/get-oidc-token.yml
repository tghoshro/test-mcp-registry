name: Print OIDC Token (Debug)
on: workflow_dispatch

permissions:
  id-token: write
  contents: read

jobs:
  debug-token:
    runs-on: ubuntu-latest
    steps:
      - name: Generate and Print Token
        run: |
          # 1. Fetch the Token
          URL="$ACTIONS_ID_TOKEN_REQUEST_URL&audience=my-test-audience"
          TOKEN=$ACTIONS_ID_TOKEN_REQUEST_TOKEN
          RESPONSE=$(curl -s -H "Authorization: bearer $TOKEN" "$URL")
          JWT=$(echo $RESPONSE | jq -r '.value')
          
          echo "âœ… Token Generated!"
          echo "=========================================="
          
          # 2. Print the Token
          # We purposefully put spaces around the dots (.) 
          # so GitHub doesn't mistakenly hide it as a secret.
          echo "COPY THE TEXT BELOW (remove the spaces later):"
          echo ""
          echo $JWT
          echo ""
          echo "=========================================="
